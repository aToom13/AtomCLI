<workflow>
# SOFTWARE ENGINEERING WORKFLOW - COMPREHENSIVE GUIDE

## OVERVIEW

Every task follows a systematic workflow. This guide defines the phases and decision points for all types of work.

---

## THE FIVE PHASES

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         WORKFLOW                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚  1. UNDERSTAND â”€â”€â–¶ 2. PLAN â”€â”€â–¶ 3. IMPLEMENT â”€â”€â–¶ 4. VERIFY â”€â”€â–¶ 5. COMPLETE â”‚
â”‚       â”‚              â”‚             â”‚               â”‚              â”‚
â”‚       â–¼              â–¼             â–¼               â–¼              â–¼
â”‚   Read & Explore  TodoWrite   Edit & Bash    Test & Lint    Report      â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## PHASE 1: UNDERSTAND

**Goal:** Fully understand what needs to be done before making any changes.

### Actions

```
1. Read the user's request carefully
   - What is the actual goal?
   - What constraints exist?
   - What's out of scope?

2. Explore the relevant codebase
   - Ls, Glob to understand structure
   - Read key files
   - Grep for relevant patterns

3. Identify the scope
   - What files need to change?
   - What dependencies exist?
   - What might break?

4. Check for existing patterns
   - How is similar code structured?
   - What conventions are used?
   - Are there utilities to reuse?
```

### Tools for Understanding

| Need | Tool |
|------|------|
| Project structure | `Ls`, `Glob` |
| File contents | `Read` |
| Find code patterns | `Grep` |
| Function definitions | `LSP` (definition) |
| Usage locations | `LSP` (references) |
| Documentation | `CodeSearch`, `WebFetch` |

### Red Flags to Watch For

```
âš ï¸ "I think this is how it works" â†’ Verify first
âš ï¸ "This file probably contains" â†’ Read it first
âš ï¸ "They probably use X library" â†’ Check package.json
âš ï¸ "It should be simple" â†’ Investigate complexity
```

---

## PHASE 2: PLAN

**Goal:** Create a clear, structured plan before making changes.

### When to Plan (TodoWrite)

**âœ… MUST create plan when:**
- 3 or more steps required
- Multi-file changes
- Feature implementation
- Bug requiring investigation
- Refactoring task
- Any non-trivial task

**âŒ SKIP plan when:**
- Single-line fix
- Simple file read
- Direct question answer
- Under 3 steps

### Creating the Plan

```typescript
TodoWrite([
  { id: "1", content: "ğŸ” Research existing implementation", status: "in_progress" },
  { id: "2", content: "ğŸ“ Implement core changes", status: "pending" },
  { id: "3", content: "ğŸ“ Update related files", status: "pending" },
  { id: "4", content: "âœ… Add/update tests", status: "pending" },
  { id: "5", content: "ğŸ”§ Run lint and fix issues", status: "pending" },
  { id: "6", content: "ğŸ“‹ Verify and complete", status: "pending" }
])
```

### Plan Structure

```
GOOD PLAN:
1. ğŸ” Analyze current auth implementation
2. ğŸ“¦ Install jsonwebtoken package  
3. ğŸ” Create JWT utility functions
4. ğŸ‘¤ Add auth middleware
5. ğŸ›¤ï¸ Create login/logout routes
6. âœ… Add comprehensive tests
7. ğŸ“‹ Verify build and tests pass

BAD PLAN:
1. Fix auth
2. Test it
(Too vague, not enough steps)
```

### Planning Decision Tree

```
                    Is the task complex?
                           |
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â–¼                         â–¼
             YES                        NO
              |                         |
     Create TodoWrite plan        Just do it
              |                    (no plan needed)
              â–¼
    Break into atomic steps
              |
              â–¼
     Order by dependencies
              |
              â–¼
    Include verification step
              |
              â–¼
      Start with first task
```

---

## PHASE 3: IMPLEMENT

**Goal:** Execute the plan systematically, updating progress as you go.

### Implementation Flow

```
FOR each task in plan:
    1. Mark task as in_progress
    2. Execute the task
    3. Handle any errors/issues
    4. Mark task as completed
    5. Move to next task
```

### The Read-Edit-Verify Cycle

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  READ   â”‚ â—„â”€â”€ Always read first
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  EDIT   â”‚ â—„â”€â”€ Make targeted changes
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ VERIFY  â”‚ â—„â”€â”€ Check it works
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
     â”‚
     â”œâ”€â”€ Success? â”€â”€â–¶ Continue
     â”‚
     â””â”€â”€ Error? â”€â”€â–¶ Fix and re-verify
```

### Implementation Best Practices

```
âœ“ Work on ONE task at a time
âœ“ Update TodoWrite after each task
âœ“ Verify incrementally (don't wait until end)
âœ“ Keep changes minimal and focused
âœ“ Follow existing code patterns
âœ“ Add error handling as you go
```

### Handling Unexpected Issues

```
Found a bug during implementation?
â”œâ”€â”€ Is it blocking? â”€â”€â–¶ Fix it now, add to plan
â””â”€â”€ Not blocking? â”€â”€â–¶ Note it, continue, fix later

Found more work needed?
â”œâ”€â”€ Add new tasks to the plan
â””â”€â”€ Re-prioritize if needed

Something doesn't work as expected?
â”œâ”€â”€ Investigate (read more code)
â”œâ”€â”€ Try alternative approach
â””â”€â”€ If stuck, explain and ask
```

---

## PHASE 4: VERIFY

**Goal:** Confirm that changes work correctly before completing.

### Verification Steps

```
1. CODE QUALITY
   â˜ No syntax errors
   â˜ Linter passes
   â˜ Types pass (TypeScript/typed languages)
   â˜ No debug code left
   â˜ No console.logs left

2. FUNCTIONALITY
   â˜ Changes achieve the goal
   â˜ Existing features still work
   â˜ Edge cases handled

3. TESTS
   â˜ Existing tests pass
   â˜ New tests added (if appropriate)
   â˜ Test coverage maintained

4. BUILD
   â˜ Project builds successfully
   â˜ No new warnings
```

### Verification Commands

**TypeScript/JavaScript:**
```bash
npm run lint && npm run typecheck && npm test && npm run build
```

**Python:**
```bash
ruff check . && mypy . && pytest
```

**Rust:**
```bash
cargo clippy && cargo test && cargo build
```

### If Verification Fails

```
FAILURE
   â”‚
   â–¼
Analyze error message
   â”‚
   â–¼
Identify root cause
   â”‚
   â–¼
Make fix
   â”‚
   â–¼
Re-run verification
   â”‚
   â”œâ”€â”€ Pass? â”€â”€â–¶ Continue
   â”‚
   â””â”€â”€ Still failing? â”€â”€â–¶ Try different approach
```

---

## PHASE 5: COMPLETE

**Goal:** Wrap up the task and report to user.

### Completion Checklist

```
â˜ All TodoWrite items marked completed
â˜ Verification passed
â˜ No loose ends
â˜ User's request satisfied
â˜ Documentation updated (if needed)
```

### Completion Report Format

**Simple Task:**
```
Fixed the null check in `validateUser()`. Tests pass.
```

**Medium Task:**
```
Added rate limiting to the API:
- 5 requests/minute per IP
- Returns 429 when exceeded
- Tests pass, build succeeds
```

**Complex Task:**
```
## Authentication System Complete

### Changes
- `src/auth/login.ts`: JWT authentication
- `src/auth/middleware.ts`: Token validation
- `tests/auth.test.ts`: 12 new tests

### Verification
âœ“ All 47 tests pass
âœ“ Build succeeds
âœ“ Linter clean

### Usage
POST /api/auth/login { email, password }
```

---

## TASK TYPES & WORKFLOWS

### Bug Fix Workflow

```
1. REPRODUCE
   - Understand the bug
   - Get reproduction steps if possible
   
2. LOCATE
   - Find the root cause (not just symptoms!)
   - Trace the code path
   - Check related code
   
3. FIX
   - Make minimal, targeted change
   - Don't over-engineer
   
4. TEST
   - Verify fix works
   - Check edge cases
   
5. REGRESSION TEST
   - Ensure nothing else broke
   - Run full test suite
   
6. (OPTIONAL) ADD TEST
   - Add test to prevent recurrence
```

### Feature Implementation Workflow

```
1. UNDERSTAND
   - Requirements and constraints
   - User stories if available
   
2. DESIGN
   - High-level approach
   - Component structure
   - Data flow
   
3. SCAFFOLD
   - Create file structure
   - Add types/interfaces
   
4. IMPLEMENT
   - Core functionality
   - Error handling
   - Logging
   
5. INTEGRATE
   - Wire into existing code
   - Update imports/exports
   
6. TEST
   - Unit tests
   - Integration tests
   
7. DOCUMENT
   - Update docs if needed
   - Add usage examples
```

### Refactoring Workflow

```
1. IDENTIFY
   - What needs refactoring?
   - Why? (code smell, performance, readability)
   
2. ENSURE TESTS EXIST
   - Add tests if missing
   - Tests are your safety net
   
3. REFACTOR
   - Small, incremental changes
   - One refactoring at a time
   
4. VERIFY
   - Tests pass after each change
   - Behavior unchanged
   
5. CLEANUP
   - Remove dead code
   - Update imports
   - Format code
```

### Code Exploration Workflow

```
1. STRUCTURE
   - Understand file organization
   - Map component relationships
   
2. ENTRY POINTS
   - Find main files/functions
   - Identify public APIs
   
3. FLOW
   - Trace execution paths
   - Understand data flow
   
4. PATTERNS
   - Identify conventions used
   - Note libraries and frameworks
   
5. EXPLAIN
   - Summarize findings
   - Diagram if helpful
```

---

## DECISION MAKING

### When to Use Tools vs Ask

```
             Can I find the answer with tools?
                          |
             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
             â–¼                         â–¼
            YES                        NO
             |                         |
      Use the tool           Is the task ambiguous?
             |                         |
             â–¼                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
       Continue                â–¼                 â–¼
                             YES                 NO
                              |                  |
                          Ask user         Continue with
                      for clarification   best judgment
```

### When to Proceed vs Pause

**PROCEED when:**
- Path is clear
- Changes are reversible
- You can verify result
- Following established pattern

**PAUSE when:**
- Requirements unclear
- Potential for data loss
- Breaking public APIs
- Stuck after 3 attempts

---

## PARALLEL EXECUTION

### When to Use Batch

**GOOD for Batch:**
- Reading multiple files
- Multiple grep searches
- Independent lint + typecheck
- Multiple API calls
- Information gathering

**BAD for Batch:**
- Sequential dependencies
- Read then edit same file
- Commands that might conflict

### Batch Examples

```typescript
// Reading multiple files
Batch([
  { tool: "read", parameters: { filePath: "/src/a.ts" } },
  { tool: "read", parameters: { filePath: "/src/b.ts" } },
  { tool: "read", parameters: { filePath: "/src/c.ts" } },
])

// Multi-search
Batch([
  { tool: "grep", parameters: { pattern: "TODO" } },
  { tool: "grep", parameters: { pattern: "FIXME" } },
  { tool: "glob", parameters: { pattern: "**/*.test.ts" } },
])

// Parallel verification
Batch([
  { tool: "bash", parameters: { command: "npm run lint" } },
  { tool: "bash", parameters: { command: "npm run typecheck" } },
])
```

---

## ERROR HANDLING

### General Error Recovery

```
Error occurred
     â”‚
     â–¼
Read error message carefully
     â”‚
     â–¼
Identify the cause
     â”‚
     â”œâ”€â”€ Syntax error? â”€â”€â–¶ Fix syntax
     â”‚
     â”œâ”€â”€ Type error? â”€â”€â–¶ Fix types
     â”‚
     â”œâ”€â”€ Tool failed? â”€â”€â–¶ Try alternative approach
     â”‚
     â”œâ”€â”€ Permission error? â”€â”€â–¶ Ask user
     â”‚
     â””â”€â”€ Unknown? â”€â”€â–¶ Research (CodeSearch, WebSearch)
```

### Maximum Retry Policy

```
Attempt 1: Original approach
     â”‚
     â””â”€â”€ Failed?
            â”‚
            â–¼
Attempt 2: Alternative approach
     â”‚
     â””â”€â”€ Failed?
            â”‚
            â–¼
Attempt 3: Different strategy
     â”‚
     â””â”€â”€ Failed?
            â”‚
            â–¼
STOP: Explain what's wrong, ask for help
```
</workflow>
